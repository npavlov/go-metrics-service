version: "2"
overrides:
  go:
    rename:
      "mtr_metrics": StorageData
      "MtrMetric": StorageData
sql:
  - engine: "postgresql"
    queries: "sql/query.sql"
    schema: "migrations"
    gen:
      go:
        package: "db"
        out: "internal/server/db"
        sql_package: "database/sql"
        emit_json_tags: true
        emit_db_tags: true
        emit_exported_queries: true
        "overrides": [
          {
            "column": "mtr_metrics.id",
            "go_type": {
              "import": "github.com/npavlov/go-metrics-service/internal/domain",
              "package": "domain",
              "type": "MetricName",
            },
            "go_struct_tag": "validate:\"required\""
          },
          {
            "column": "mtr_metrics.type",
            "go_type": {
              "import": "github.com/npavlov/go-metrics-service/internal/domain",
              "package": "domain",
              "type": "MetricType",
            },
            "go_struct_tag": "validate:\"required,oneof=counter gauge\""
          },
          {
            "column": "mtr_metrics.delta",
            "go_type": {
              "type": "int64",
              "pointer": true
            },
          },
          {
            "column": "mtr_metrics.value",
            "go_type": {
              "type": "float64",
              "pointer": true
            },
          }
        ]
        rename:
          id: "ID"
          type: "MType"